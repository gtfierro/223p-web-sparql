@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix quantitykind: <http://qudt.org/vocab/quantitykind/> .
@prefix qudt: <http://qudt.org/schema/qudt/> .
@prefix unit: <http://qudt.org/vocab/unit/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix s223: <http://data.ashrae.org/standard223#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <urn:medium-office/> .

<urn:medium-office/>
  a owl:Ontology ;
  owl:imports <http://data.ashrae.org/standard223/1.0/model/all> ;
.

# AHU wraps the devices inside
:ahu a s223:AHU ;
    s223:contains :cooling-coil-2stage, :heating-coil-1stage, :fan, :economizer ;
    s223:servesVAV :vav1 ;
    # AHU has 3 connection points: supply, return and outside air
    s223:hasSystemConnectionPoint :ahu-supply-conn, :ahu-return-conn, :ahu-outside-conn .
:ahu-outside-conn a s223:InletSystemConnectionPoint ;
    s223:hasMedium s223:Medium-Air ;
    s223:mapsTo :economizer-outside-air .
:ahu-return-conn a s223:InletSystemConnectionPoint ;
    s223:hasMedium s223:Medium-Air ;
    s223:mapsTo :economizer-return-air .
:ahu-supply-conn a s223:OutletSystemConnectionPoint ;
    s223:mapsTo :fan-out ;
    s223:hasMedium s223:Medium-Air .

# economizer
:economizer-outside-air a s223:InletConnectionPoint ;
    # TODO: connect to outside air
    s223:hasMedium s223:Medium-Air .
:economizer-return-air a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:economizer a s223:Economizer ;
    s223:cnx :economizer-mixed-air, :economizer-outside-air, :economizer-return-air .
:economizer-mixed-air a s223:OutletConnectionPoint ;
    # this goes to the mixed air region
    s223:hasMedium s223:Medium-Air .

# mixed air goes to the cooling coil
:mixed-air-duct a s223:Duct ;
    s223:cnx :economizer-mixed-air, :cooling-coil-in .

# cooling coil
:cooling-coil-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:cooling-coil-2stage a s223:CoolingCoil ;
    s223:cnx :cooling-coil-in, :cooling-coil-out ;
    s223:contains :cooling-coil-power-sensor, :cooling-coil-total-cooling-sensor ;
    s223:hasProperty :cooling-coil-power, :cooling-coil-total-cooling .
:cooling-coil-power a s223:QuantifiableObservableProperty ;
    rdfs:label "instantaneous cooling output" ;
    qudt:unit unit:W ;
    qudt:hasQuantityKind quantitykind:Power .
:cooling-coil-power-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :cooling-coil-2stage ;
    s223:observesProperty :cooling-coil-power .
:cooling-coil-total-cooling a s223:QuantifiableObservableProperty ;
    rdfs:label "total delivered cooling" ;
    qudt:unit unit:W ;
    qudt:hasQuantityKind quantitykind:Power .
:cooling-coil-total-cooling-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :cooling-coil-2stage ;
    s223:observesProperty :cooling-coil-total-cooling .
:cooling-coil-out a s223:OutletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .

# cooling coil connects to heating coil
:duct1 a s223:Duct ;
    s223:cnx :cooling-coil-out, :heating-coil-in ;
.

# heating coil
:heating-coil-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:heating-coil-1stage a s223:HeatingCoil ;
    s223:cnx :heating-coil-in, :heating-coil-out ;
    s223:contains :heating-coil-power-sensor, :heating-coil-total-heating-sensor ;
    s223:hasProperty :heating-coil-power, :heating-coil-total-heating, :heating-coil-onoff .
:heating-coil-onoff a s223:EnumeratedActuatableProperty ;
    rdfs:label "heating coil on/off" ;
    s223:hasEnumerationKind s223:EnumerationKind-RunStatus .
:heating-coil-power a s223:QuantifiableObservableProperty ;
    rdfs:label "instantaneous heating output" ;
    qudt:unit unit:W ;
    qudt:hasQuantityKind quantitykind:ElectricPower .
:heating-coil-power-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :heating-coil-1stage ;
    s223:observesProperty :heating-coil-power .
:heating-coil-total-heating a s223:QuantifiableObservableProperty ;
    rdfs:label "total delivered heating" ;
    qudt:unit unit:W ;
    qudt:hasQuantityKind quantitykind:ElectricPower .
:heating-coil-total-heating-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :heating-coil-1stage ;
    s223:observesProperty :heating-coil-total-heating .
:heating-coil-out a s223:OutletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .

# heating coil connects to fan
:duct2 a s223:Duct ;
    s223:cnx :heating-coil-out, :fan-in .

# supply fan
:fan-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:fan a s223:Fan ;
    s223:cnx :fan-in, :fan-out ;
    s223:contains :fan-power-sensor ;
    s223:hasProperty :fan-speed, :fan-power .
:fan-speed a s223:QuantifiableActuatableProperty ;
    rdfs:label "Fan Speed"@en ;
    qudt:hasQuantityKind quantitykind:Frequency ;
    qudt:unit unit:HZ .
:fan-power a s223:QuantifiableObservableProperty ;
    rdfs:label "fan power consumption" ;
    qudt:unit unit:W ;
    qudt:hasQuantityKind quantitykind:ElectricPower .
:fan-power-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :fan ;
    s223:observesProperty :fan-power .
:fan-out a s223:OutletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .

# fan marks the boundary of the AHU

# ducts connect the AHU to each VAV
:ahu-to-vav1 a s223:Duct ;
    s223:cnx :fan-out, :vav1-rhc-in .

# VAV for each zone
:vav1 a s223:VAV ;
    s223:contains :vav1-rhc, :vav1-dmp, :vav1-sup-air-flow-sensor, :vav1-sup-air-temp-sensor, :vav1-sup-air-humidity-sensor ;
    s223:servesZone :zone1 ;
    s223:hasSystemConnectionPoint :vav1-in, :vav1-out .
:vav1-in a s223:InletSystemConnectionPoint ;
    s223:mapsTo :vav1-dmp-in ;
    s223:hasMedium s223:Medium-Air .
:vav1-out a s223:OutletSystemConnectionPoint ;
    s223:mapsTo :vav1-rhc-out ;
    s223:hasMedium s223:Medium-Air .

# vav damper
:vav1-dmp a s223:Damper ;
    s223:cnx :vav1-dmp-in, :vav1-dmp-out .
:vav1-dmp-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:vav1-dmp-out a s223:OutletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .

# reheat coil connects to damper
:vav1-dmp-to-rhc a s223:Duct ;
    s223:cnx :vav1-dmp-out, :vav1-rhc-in .

# reheat coil inside VAV
:vav1-rhc a s223:HeatingCoil ;
    s223:hasProperty :vav1-rhc-onoff ;
    s223:cnx :vav1-rhc-in, :vav1-rhc-out .
:vav1-rhc-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:vav1-rhc-out a s223:OutletConnectionPoint ;
    s223:hasProperty :vav1-sup-air-flow, :vav1-sup-air-temp, :vav1-sup-air-humidity ;
    s223:hasMedium s223:Medium-Air .
:vav1-rhc-onoff a s223:EnumeratedActuatableProperty ;
    rdfs:label "reheat coil on/off" ;
    s223:hasEnumerationKind s223:EnumerationKind-RunStatus .

# properties of vav supply air
:vav1-sup-air-flow a s223:QuantifiableObservableProperty ;
    rdfs:label "supply air flow" ;
    qudt:unit unit:FT3-PER-MIN ;
    qudt:hasQuantityKind quantitykind:VolumeFlowRate .
:vav1-sup-air-flow-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :vav1-dmp-out ;
    s223:observesProperty :vav1-sup-air-flow .
:vav1-sup-air-temp a s223:QuantifiableObservableProperty ;
    rdfs:label "supply air temperature" ;
    qudt:unit unit:DEG_C ;
    qudt:hasQuantityKind quantitykind:ThermodynamicTemperature .
:vav1-sup-air-temp-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :vav1-dmp-out ;
    s223:observesProperty :vav1-sup-air-temp .
:vav1-sup-air-humidity a s223:QuantifiableObservableProperty ;
    rdfs:label "supply air humidity" ;
    qudt:unit unit:PERCENT ;
    qudt:hasQuantityKind quantitykind:DimensionlessRatio .
:vav1-sup-air-humidity-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :vav1-dmp-out ;
    s223:observesProperty :vav1-sup-air-humidity .
# end of VAV

# VAV connects to the zone
:vav1-to-zone1  a s223:Duct ;
    s223:cnx :vav1-rhc-out, :zone1-hvac-space-in .

# hvac zone
:zone1 a s223:Zone ;
    s223:hasDomain s223:Domain-HVAC ;
    s223:hasZoneConnectionPoint :zone1-in, :zone1-out ;
    s223:contains :zone1-hvac-space .
:zone1-in a s223:InletZoneConnectionPoint ;
    s223:mapsTo :zone1-hvac-space-in ;
    s223:hasMedium s223:Medium-Air .
:zone1-out a s223:OutletZoneConnectionPoint ;
    s223:mapsTo :zone1-hvac-space-out ;
    s223:hasMedium s223:Medium-Air .
:zone1-hvac-space a s223:DomainSpace ;
    s223:hasProperty :zone1-temp, :zone1-flow, :zone1-humidity ;
    s223:cnx :zone1-hvac-space-in, :zone1-hvac-space-out ;
    s223:hasDomain s223:Domain-HVAC .
:zone1-hvac-space-in a s223:InletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .
:zone1-hvac-space-out a s223:OutletConnectionPoint ;
    s223:hasMedium s223:Medium-Air .

:zone1-temp a s223:QuantifiableObservableProperty ;
    rdfs:label "Temperature"@en ;
    s223:hasSetpoint :zone1-temp-setpoint ;
    qudt:unit unit:DEG_C ;
    qudt:hasQuantityKind quantitykind:ThermodynamicTemperature .
:zone1-temp-setpoint a s223:Setpoint ;
    rdfs:label "Zone Air Temperature Setpoint"@en ;
    s223:hasAspect s223:Medium-Air, s223:HVACOperatingMode-HeatOnly ;
    qudt:hasQuantityKind quantitykind:ThermodynamicTemperature .
:zone1-temp-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :zone1-hvac-space-in ;
    s223:observesProperty :zone1-temp .

:zone1-flow a s223:QuantifiableObservableProperty ;
    rdfs:label "Zone Air Flow"@en ;
    s223:hasSetpoint :zone1-flow-setpoint ;
    qudt:unit unit:FT3-PER-MIN ;
    qudt:hasQuantityKind quantitykind:VolumeFlowRate .
:zone1-flow-setpoint a s223:Setpoint ;
    rdfs:label "Zone Air Flow Setpoint"@en ;
    s223:hasAspect s223:Medium-Air ;
    qudt:hasQuantityKind quantitykind:VolumeFlowRate .
:zone1-flow-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :zone1-hvac-space-in ;
    s223:observesProperty :zone1-flow .

:zone1-humidity a s223:QuantifiableObservableProperty ;
    rdfs:label "Humidity"@en ;
    s223:hasSetpoint :zone1-humidity-setpoint ;
    qudt:unit unit:PERCENT ;
    qudt:hasQuantityKind quantitykind:DimensionlessRatio .
:zone1-humidity-setpoint a s223:Setpoint ;
    rdfs:label "Zone Humidity Setpoint"@en ;
    s223:hasAspect s223:Medium-Air ;
    qudt:hasQuantityKind quantitykind:DimensionlessRatio .
:zone1-humidity-sensor a s223:Sensor ;
    s223:hasMeasurementLocation :zone1-hvac-space-in ;
    s223:observesProperty :zone1-humidity .
# end of zone

# return from zone
:return-duct a s223:Duct ;
    s223:cnx :zone1-hvac-space-out, :economizer-return-air .
